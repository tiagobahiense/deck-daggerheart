<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Grim√≥rio Daggerheart</title>
    <meta name="description" content="Ficha de personagem digital e mesa virtual para Daggerheart.">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tiagobahiense.github.io/deck-daggerheart/index.html">
    <meta property="og:title" content="Grim√≥rio Daggerheart">
    <meta property="og:description" content="Crie sua ficha, role dados e gerencie seu invent√°rio online.">
    <meta property="og:image" content="https://tiagobahiense.github.io/deck-daggerheart/img/DH-portrait.webp">
    <meta property="og:image:type" content="image/webp">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tiagobahiense.github.io/deck-daggerheart/index.html">
    <meta property="twitter:title" content="Grim√≥rio Daggerheart">
    <meta property="twitter:description" content="Ficha de personagem digital e mesa virtual para Daggerheart.">
    <meta property="twitter:image" content="https://tiagobahiense.github.io/deck-daggerheart/img/DH-portrait.webp">
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <link rel="stylesheet" href="style.css?v=10.3">
    <link rel="stylesheet" href="profissao.css?v=1.0">
    <link rel="stylesheet" href="selecao-classe.css?v=3.0">
    <link rel="stylesheet" href="ficha.css?v=6.0"> 
    <link rel="stylesheet" href="dados.css?v=2.0">
    <link rel="stylesheet" href="inimigos.css?v=3.6">
    <link rel="stylesheet" href="medo.css?v=1.0">
    <link rel="stylesheet" href="npcs.css">
    <link rel="stylesheet" href="tabletop.css">
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        .btn-refresh-player { position: absolute; top: 15px; right: 15px; background: rgba(0, 0, 0, 0.7); border: 2px solid #555; color: #aaa; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; z-index: 9999; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
        .btn-refresh-player:hover { border-color: var(--gold); color: var(--gold); transform: rotate(180deg); background: rgba(0, 0, 0, 0.9); }
        .spin-anim { animation: spin 1s linear infinite; color: var(--gold); border-color: var(--gold); }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="loading-overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:20000; display:flex; flex-direction:column; align-items:center; justify-content:center; color:#d4af37; font-family:'MedievalSharp';">
        <div style="font-size: 2rem; margin-bottom: 20px;">Carregando Grim√≥rio...</div>
        <div class="spin-anim" style="font-size: 3rem;">‚öîÔ∏è</div>
    </div>

    <div id="medo-overlay-msg"></div>

    <div id="login-screen">
        <div class="login-box" id="fase-selecao">
            <h1>Grim√≥rio Daggerheart</h1>
            <p>Escolha seu destino</p>
            <div style="display: flex; gap: 20px; justify-content: center; margin-top: 20px;">
                <button type="button" class="btn-main" onclick="irParaLoginJogador()">Sou Jogador</button>
                <button type="button" class="btn-main" onclick="irParaLoginNarrador()" style="background: #8b0000; color: #fff; border: 2px solid #ff4444;">Sou Narrador</button>
            </div>
            <button type="button" onclick="forcarLogout()" style="background: transparent; color: #666; border: none; font-size: 0.8rem; margin-top: 20px;">For√ßar Logout (Reset)</button>
        </div>

        <div class="login-box" id="fase-login-jogador" style="display: none;">
            <h1>Acesso do Jogador</h1>
            <p>Insira suas credenciais</p>
            <div class="input-group"><input type="email" id="player-email" placeholder="Email" class="input-login"></div>
            <div class="input-group"><input type="password" id="player-pass" placeholder="Senha" class="input-login"><span class="toggle-password" onclick="togglePassword('player-pass')">üëÅÔ∏è</span></div>
            <div id="error-msg-player"></div>
            <button type="button" class="btn-entrar" onclick="fazerLoginJogador()">Entrar</button>
            <button type="button" class="btn-voltar" onclick="voltarParaSelecao()">Voltar</button>
        </div>

        <div class="login-box" id="fase-login-narrador" style="display: none;">
            <h1>Acesso do Narrador</h1>
            <p>√Årea Restrita</p>
            <div class="input-group"><input type="email" id="narrador-email" placeholder="Email" class="input-login"></div>
            <div class="input-group"><input type="password" id="narrador-pass" placeholder="Senha" class="input-login"><span class="toggle-password" onclick="togglePassword('narrador-pass')">üëÅÔ∏è</span></div>
            <div id="error-msg-narrador"></div>
            <button type="button" class="btn-entrar" onclick="fazerLoginNarrador()">Acessar Admin</button>
            <button type="button" class="btn-voltar" onclick="voltarParaSelecao()">Voltar</button>
        </div>

        <div class="login-box" id="fase-personagem" style="display: none;">
            <h1>Seus Personagens</h1>
            <p>Escolha um personagem existente ou crie um novo</p>
            <div id="lista-personagens" style="margin: 20px 0; min-height: 100px;">
                <p style="color: #888; text-align: center;">Carregando...</p>
            </div>
            <div style="border-top: 1px solid #444; padding-top: 15px; margin-top: 15px;">
                <p style="margin-bottom: 10px; color: #aaa; font-size: 0.9rem;">Criar novo personagem:</p>
                <input type="text" id="nome-personagem" placeholder="Nome do Novo Personagem" class="input-login" autocomplete="off" style="margin-bottom: 10px;">
                <button type="button" class="btn-entrar" onclick="criarNovoPersonagem()">Criar e Jogar</button>
            </div>
            <button type="button" class="btn-voltar" onclick="voltarParaSelecao()" style="margin-top: 15px;">Cancelar</button>
        </div>
    </div>

    <div id="classe-selection-modal" class="modal-selecao"><div class="classe-carousel-wrapper"><div class="selecao-header"><h2>Escolha sua Classe</h2><p>Clique na imagem para ler</p></div><div class="carousel-main"><button class="nav-btn prev" onclick="window.mudarClasse(-1)">‚ùÆ</button><div class="card-display" onclick="window.verDetalhesClasse()"><div class="card-glow"></div><img id="img-classe-perfil" class="img-perfil-animada"><div class="card-label"><span id="nome-classe-selecao">CLASSE</span></div></div><button class="nav-btn next" onclick="window.mudarClasse(1)">‚ùØ</button></div><div class="selecao-footer"><button class="btn-confirmar-final" onclick="window.confirmarSelecaoClasse()">‚úì Confirmar <span id="btn-nome-classe">Classe</span></button></div></div></div>
    <div id="modal-detalhes-classe" class="modal" style="z-index: 7000;"><div class="modal-detalhes-content"><button class="close-detalhes" onclick="window.fecharDetalhesClasse()">X</button><div class="pdf-wrapper"><button class="nav-pdf-btn prev" onclick="window.mudarPaginaPDF(-1)">‚ùÆ</button><div class="pdf-container"><img id="img-classe-pdf"></div><button class="nav-pdf-btn next" onclick="window.mudarPaginaPDF(1)">‚ùØ</button></div><div class="detalhes-footer"><div class="page-counter" id="pdf-page-counter">1/2</div><button class="btn-confirmar-final" onclick="window.confirmarSelecaoClasseDeDentro()">Escolher</button></div></div></div>
    
    <div id="modal-leitor-pdf" class="modal" style="z-index: 7500;">
        <div class="modal-leitor-content">
            <button class="close-detalhes" onclick="window.fecharLeitorPDF()">X</button>
            <div class="leitor-header">
                <h2 id="titulo-leitor-pdf" style="color: var(--gold); margin: 0;">Consulta</h2>
            </div>
            <div class="pdf-wrapper">
                <button class="nav-pdf-btn prev" onclick="window.mudarPaginaLeitor(-1)">‚ùÆ</button>
                <div class="pdf-container">
                    <img id="img-leitor-pdf" src="" alt="P√°gina">
                </div>
                <button class="nav-pdf-btn next" onclick="window.mudarPaginaLeitor(1)">‚ùØ</button>
            </div>
            <div class="detalhes-footer">
                <div class="page-counter" id="leitor-page-counter">1/1</div>
            </div>
        </div>
    </div>

    <div id="sheet-modal" class="modal">
        <div class="sheet-content">
            
            <div class="sheet-toolbar">
                <button class="tool-btn active" onclick="selecionarFerramenta('texto')" title="Ferramenta de Texto">T</button>
                <button class="tool-btn" onclick="selecionarFerramenta('marcador')" title="Marcador">‚óè</button>
                <button class="tool-btn" onclick="limparPaginaAtual()" style="color:#f66;" title="Limpar Tudo">üóëÔ∏è</button>
                
                <div class="color-separator" style="height: 1px; width: 20px; background: #555; margin: 5px 0;"></div>
                <button class="tool-btn btn-guia" onclick="toggleTutorial()" title="Guia de Preenchimento">Guia</button>
            </div>

            <button class="btn-close-sheet" onclick="fecharFicha()">X</button>
            
            <div class="sheet-container" id="sheet-container">
                <img id="sheet-bg">
                <div id="sheet-inputs-layer"></div>
            </div>
            
            <div class="sheet-footer">
                <button class="nav-simple-btn" onclick="mudarPaginaFicha(-1)">‚ùÆ</button>
                <span id="sheet-page-indicator">1</span>
                <button class="nav-simple-btn" onclick="mudarPaginaFicha(1)">‚ùØ</button>
            </div>
        </div>
    </div>

    <div id="tutorial-overlay">
        <div class="tutorial-box">
            <button class="close-tutorial-btn" onclick="toggleTutorial()">√ó</button>
            <div class="tutorial-scroll">
                <h2 style="color: var(--gold); text-align: center; border-bottom: 1px solid var(--gold); padding-bottom: 10px;">Guia de Preenchimento da Ficha</h2>
                
                <h3>1. Escolha de Classe e N√≠vel</h3>
                <ul>
                    <li><strong>Classe:</strong> Escolha sua classe (ex: Bardo, Guerreiro, Mago). Anote-a no topo da ficha.</li>
                    <li><strong>Subclasse:</strong> Escolha a carta <strong>Fundamental</strong> da sua subclasse. Isso define seu estilo de jogo inicial.</li>
                    <li><strong>N√≠vel:</strong> Anote <strong>1</strong> no campo de n√≠vel (canto superior).</li>
                    <li><strong>Habilidade de Classe:</strong> Cada classe tem uma habilidade passiva ou ativa √∫nica pr√©-impressa ou descrita no guia. Voc√™ n√£o precisa escrev√™-la se estiver usando a ficha espec√≠fica da classe, mas deve conhec√™-la.</li>
                </ul>

                <h3>2. Heran√ßa (Ancestralidade e Comunidade)</h3>
                <p>Sua heran√ßa define quem voc√™ √© e de onde veio. Anote no campo <strong>Heran√ßa</strong>:</p>
                <ul>
                    <li><strong>Ancestralidade:</strong> Escolha uma (ex: Elfo, An√£o, Galapa). Ela concede <strong>duas</strong> habilidades descritas na carta de ancestralidade.</li>
                    <li><strong>Comunidade:</strong> Escolha uma (ex: Subterr√¢nea, N√¥made, Erudita). Ela concede <strong>uma</strong> habilidade descrita na carta de comunidade.</li>
                    <li><strong>Nota:</strong> Mantenha as cartas fisicamente com voc√™ ou anote os efeitos na ficha.</li>
                </ul>

                <h3>3. Atributos</h3>
                <p>Distribua os seguintes modificadores entre seus seis atributos (<strong>Agilidade, For√ßa, Acuidade, Instinto, Presen√ßa, Conhecimento</strong>):</p>
                <p style="text-align: center; font-weight: bold; color: var(--gold); background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">+2, +1, +1, 0, 0, ‚Äì1</p>
                <p>Anote o n√∫mero na caixa correspondente a cada atributo.</p>

                <h3>4. Caracter√≠sticas de Combate e Vida</h3>
                <p>Preencha os campos baseados na sua Classe (consulte a tabela da classe ou carta de refer√™ncia):</p>
                <ul>
                    <li><strong>Evas√£o:</strong> √â a dificuldade para te acertarem. (Ex: Bardo tem Evas√£o 10, Guerreiro 9).</li>
                    <li><strong>Pontos de Vida (PV):</strong> Seu total de vida. (Ex: Druida tem 6 espa√ßos).</li>
                    <li><strong>Limiar de Estresse (Fadiga):</strong> A maioria das classes come√ßa com <strong>6</strong> espa√ßos de Estresse.</li>
                    <li><strong>Esperan√ßa:</strong> Voc√™ come√ßa a sess√£o com <strong>2</strong> pontos de Esperan√ßa marcados.</li>
                </ul>

                <h3>5. Equipamento Inicial</h3>
                <h4>Armadura</h4>
                <ul>
                    <li>Anote o valor de <strong>Armadura</strong> do item inicial (ex: Couro = 3).</li>
                    <li><strong>Limiares de Dano (Thresholds):</strong> A armadura fornece valores base (ex: Menor 2 / Maior 4). <strong>Some seu N√≠vel</strong> a esses valores.</li>
                    <li><em>Exemplo (N√≠vel 1):</em> Base 2/4 ‚Üí anote <strong>3</strong> (Menor) e <strong>5</strong> (Maior) na se√ß√£o <em>Sa√∫de e Dano</em>.</li>
                </ul>

                <h4>Armas Ativas</h4>
                <ul>
                    <li>Escolha uma arma <strong>Prim√°ria</strong> e uma <strong>Secund√°ria</strong>.</li>
                    <li>Anote: Nome, Atributo usado (ex: For√ßa), Alcance, Dados de Dano (ex: 1d8), Tipo (F√≠sico ou M√°gico) e Habilidades da arma.</li>
                    <li><strong>Profici√™ncia:</strong> Marque o primeiro c√≠rculo (<strong>valor 1</strong>). Isso indica quantos dados voc√™ rola no dano.</li>
                </ul>

                <h3>6. Experi√™ncias</h3>
                <p>Crie <strong>duas frases curtas</strong> que definam o passado ou habilidades do seu personagem (ex: <em>‚ÄúGuarda-costas Leal‚Äù</em>, <em>‚ÄúLadr√£o de Telhados‚Äù</em>).</p>
                <ul>
                    <li>Anote-as na se√ß√£o de <strong>Experi√™ncias</strong>.</li>
                    <li>Atribua o modificador <strong>+2</strong> para ambas.</li>
                </ul>

                <h3>7. Cartas de Dom√≠nio</h3>
                <p>Sua classe √© composta por <strong>dois Dom√≠nios</strong> (ex: Guerreiro = <strong>L√¢mina</strong> e <strong>Osso</strong>).</p>
                <ul>
                    <li>Escolha <strong>duas cartas de n√≠vel 1</strong> do seu baralho de Dom√≠nios (pode ser uma de cada dom√≠nio ou duas do mesmo).</li>
                    <li>Coloque-as nos espa√ßos de cartas ativas ou anote-as.</li>
                </ul>

                <h3>8. Detalhes Finais</h3>
                <ul>
                    <li><strong>Invent√°rio:</strong> Voc√™ come√ßa com um Kit B√°sico, uma Po√ß√£o de Vida Menor, uma Tocha e algumas ra√ß√µes. Anote em <em>Invent√°rio</em>.</li>
                    <li><strong>Ouro:</strong> Voc√™ come√ßa com <strong>1 Punhado</strong> (Handful) de ouro.</li>
                    <li><strong>Descri√ß√£o:</strong> Preencha seu Nome, Pronomes e descreva sua Apar√™ncia.</li>
                    <li><strong>V√≠nculos e Perguntas:</strong> Responda √†s perguntas de cria√ß√£o de personagem da sua classe para criar la√ßos com o grupo.</li>
                </ul>
                
                <p style="text-align: center; margin-top: 20px; font-style: italic; color: #888;">Pronto! Seu her√≥i est√° criado.</p>
            </div>
        </div>
    </div>
    
    <div id="hover-preview" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:350px;height:525px;background-size:contain;background-repeat:no-repeat;background-position:center;border:3px solid var(--gold);pointer-events:none;z-index:99999;"></div>
    <div id="hover-preview-modal" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:350px;height:525px;background-size:contain;background-repeat:no-repeat;background-position:center;border:3px solid var(--gold);pointer-events:none;z-index:99999;"></div>
    <div id="hover-preview-slot" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:400px;height:600px;background-size:contain;background-repeat:no-repeat;background-position:center;border:3px solid var(--gold);pointer-events:none;z-index:99999;"></div>

    <div id="player-npc-overlay"></div>
    <div id="app-container" style="display: none; opacity: 0;">

        <button id="btn-vtt-toggle" onclick="window.toggleVTTMinimizado()">‚¨áÔ∏è Minimizar</button>

        <div id="player-portrait-container" style="display:none;">
            <div class="portrait-frame">
                <img id="player-portrait-img" class="portrait-img" src="">
            </div>
        </div>

        <div id="tabletop-area" class="modo-jogador">
            <div id="map-container">
                <img id="map-bg-img" class="map-bg-img" src="">
                <div class="grid-overlay"></div>
                </div>
        </div>
        
        

        <div id="aura-profissao"></div>
        <div id="particulas-profissao"></div>

        <div id="audio-control">
            <button onclick="toggleMusic()" id="btn-music">üîä</button>
            <input type="range" id="volume" min="0" max="1" step="0.01" value="0.05" oninput="setVolume()">
        </div>
        
        <audio id="bg-music" loop><source src="audio/jornada.mp3" type="audio/mpeg"></audio>
        <audio id="use-card-sound"><source src="audio/use-card.mp3" type="audio/mpeg"></audio>
        <audio id="sound-medo-add"><source src="audio/sound-recolhe-medo.mp3" type="audio/mpeg"></audio>
        <audio id="sound-medo-use"><source src="audio/sound-usa-medo.mp3" type="audio/mpeg"></audio>

        <div id="system-message"></div>
        
        <div id="area-inimigos"></div>
        
        <div id="area-jogo">
            <section id="mesa-area">
                <div class="botoes-laterais">
                    <button class="btn-lateral" onclick="abrirLeitorPDF('Comunidade')">Comunidade</button>
                    <button class="btn-lateral" onclick="abrirLeitorPDF('Ancestralidade')">Ancestralidade</button>
                </div>
                <div class="grupo-fixo"><div class="titulo-grupo">Identidade</div><div class="slots-row"><div class="slot-fixo" onclick="abrirGrimorio('Ancestralidade', 'Ancestralidade')" id="slot-Ancestralidade"><span class="label-slot">Ancestralidade</span><button class="btn-limpar" onclick="limparSlot('Ancestralidade', event)">√ó</button></div><div class="slot-fixo" onclick="abrirGrimorio('Comunidade', 'Comunidade')" id="slot-Comunidade"><span class="label-slot">Comunidade</span><button class="btn-limpar" onclick="limparSlot('Comunidade', event)">√ó</button></div></div></div>
                <div class="grupo-fixo destaque-classe"><div class="titulo-grupo">Evolu√ß√£o de Subclasse</div><div class="slots-row"><div class="slot-classe" onclick="abrirGrimorio('Classes', 'Fundamental')" id="slot-Fundamental"><span class="label-slot">Fundamental</span><span class="nivel-req">N√≠vel 1</span><button class="btn-limpar" onclick="limparSlot('Fundamental', event)">√ó</button></div><div class="seta-evolucao">‚ûú</div><div class="slot-classe" onclick="abrirGrimorio('Classes', 'Especializacao')" id="slot-Especializacao"><span class="label-slot">Especializa√ß√£o</span><span class="nivel-req">Avan√ßo</span><button class="btn-limpar" onclick="limparSlot('Especializacao', event)">√ó</button></div><div class="seta-evolucao">‚ûú</div><div class="slot-classe" onclick="abrirGrimorio('Classes', 'Maestria')" id="slot-Maestria"><span class="label-slot">Maestria</span><span class="nivel-req">Avan√ßo</span><button class="btn-limpar" onclick="limparSlot('Maestria', event)">√ó</button></div></div></div>
            </section>
            <div id="deck-container-wrapper"><div id="deck-area" onclick="abrirGrimorio('Geral')"><div class="pote-glow"></div><img src="img/pote_deck.png" class="pote-img"><div class="label-deck">Grim√≥rio</div></div></div>
            <section id="reserva-area"><div class="titulo-reserva">Reserva (Inativas)</div><div id="cartas-reserva"></div></section>
        </div> 
        <footer id="mao-area"><div id="cartas-mao"></div><button onclick="window.abrirFichaPersonagem()" style="position: absolute; bottom: 20px; right: 20px; z-index: 2000; pointer-events: auto; padding: 10px 20px; background: var(--gold); border: 2px solid #fff; border-radius: 5px; cursor: pointer; font-weight: bold; font-family: 'MedievalSharp', cursive; font-size: 1rem; box-shadow: 0 0 10px rgba(0,0,0,0.8); color: #000;">üìù Ficha</button></footer>
        <div class="action-buttons-container">
        
            <div class="action-row">
                <button class="btn-action-rect" onclick="window.abrirFichaPersonagem()">üìù Ficha</button>
                
                <button class="btn-action-rect" onclick="window.uploadAvatarJogador()" title="Enviar Foto">üì∑ Foto</button>
            </div>
    
            <div id="btn-abrir-dados" onclick="abrirSeletorDados()" title="Rolar Dados">üé≤</div>
        </div>
        <div id="carta-tabuleiro-animada" class="carta-tabuleiro-animada"></div>
    </div>

    <div id="modal-selecao-dados" onclick="if(event.target===this) fecharSeletorDados()"><div class="dados-content"><div class="dados-header">Rolagem</div><div class="dualidade-box"><span style="color:#ddd; font-size:0.8rem;">Teste (2d12)</span><button class="btn-dualidade" onclick="adicionarDualidade()">‚ö° Dualidade</button></div><hr style="border-top:1px solid #444; width:100%;"><div class="grid-dados"><div class="dado-control"><span class="dado-label">d4</span><div class="dado-btn-group"><button class="btn-qty" onclick="alterarQtdDado('d4', -1)">-</button><span id="count-d4" class="dado-count">0</span><button class="btn-qty" onclick="alterarQtdDado('d4', 1)">+</button></div></div><div class="dado-control"><span class="dado-label">d6</span><div class="dado-btn-group"><button class="btn-qty" onclick="alterarQtdDado('d6', -1)">-</button><span id="count-d6" class="dado-count">0</span><button class="btn-qty" onclick="alterarQtdDado('d6', 1)">+</button></div></div><div class="dado-control"><span class="dado-label">d8</span><div class="dado-btn-group"><button class="btn-qty" onclick="alterarQtdDado('d8', -1)">-</button><span id="count-d8" class="dado-count">0</span><button class="btn-qty" onclick="alterarQtdDado('d8', 1)">+</button></div></div><div class="dado-control"><span class="dado-label">d10</span><div class="dado-btn-group"><button class="btn-qty" onclick="alterarQtdDado('d10', -1)">-</button><span id="count-d10" class="dado-count">0</span><button class="btn-qty" onclick="alterarQtdDado('d10', 1)">+</button></div></div><div class="dado-control"><span class="dado-label">d12</span><div class="dado-btn-group"><button class="btn-qty" onclick="alterarQtdDado('d12', -1)">-</button><span id="count-d12" class="dado-count">0</span><button class="btn-qty" onclick="alterarQtdDado('d12', 1)">+</button></div></div><div class="dado-control"><span class="dado-label">d20</span><div class="dado-btn-group"><button class="btn-qty" onclick="alterarQtdDado('d20', -1)">-</button><span id="count-d20" class="dado-count">0</span><button class="btn-qty" onclick="alterarQtdDado('d20', 1)">+</button></div></div></div><button class="btn-rolar-final" onclick="rolarDadosConfirmados()">Rolar</button></div></div>
    <div id="overlay-rolagem"><div id="quem-rolou-label"></div><div id="container-dados-rolando"></div><button id="btn-fechar-rolagem" onclick="fecharResultadoRolagem()">Fechar</button></div>
    <div id="grimorio-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="modal-titulo">Escolha uma Carta</h2><button class="close-btn" onclick="fecharGrimorio()">X</button></div><div id="grid-cartas"></div></div></div>
    <div id="decisao-modal" class="modal" style="z-index: 6000;"><div class="modal-decisao-content"><h3>Gerenciar Carta</h3><div class="carta-preview-decisao" id="preview-decisao"></div><div class="grupo-tokens"><span>Tokens:</span><button class="btn-token" onclick="alterarToken(-1)">-</button><span id="label-token-qtd">0</span><button class="btn-token" onclick="alterarToken(1)">+</button></div><div class="grupo-tokens"><button class="btn-estado" onclick="definirEstado('curto')">Descanso Curto</button><button class="btn-estado" onclick="definirEstado('longo')">Descanso Longo</button></div><div class="botoes-decisao"><button class="btn-usar-carta" id="btn-usar-carta" onclick="usarCarta()" style="display:none;">‚ö° Usar</button><button class="btn-confirmar" onclick="confirmarEdicao()">OK</button><button class="btn-reserva" id="btn-para-reserva" onclick="moverParaReserva()" style="display:none;">Reserva</button><button class="btn-deck" id="btn-devolver-mao" onclick="devolverParaMao()" style="display:none;">M√£o</button><button class="btn-deck" id="btn-devolver-deck" onclick="devolverAoDeck()" style="display:none;">Deck</button></div></div></div>
    <div id="reserva-modal" class="modal" style="z-index: 6000;"><div class="modal-reserva-content"><div class="modal-header"><h2>Reserva</h2><button class="close-btn" onclick="window.fecharReserva()">X</button></div><div id="grid-reserva"></div></div></div>
    <div id="troca-modal" class="modal" style="z-index: 6100;"><div class="modal-decisao-content"><h3>M√£o cheia!</h3><div id="grid-troca"></div><div class="botoes-decisao"><button class="btn-confirmar" onclick="window.cancelarTroca()">Cancelar</button></div></div></div>

    <script type="module" src="script.js?v=12.3"></script>
    
    <script>
        function loadScript(src) {
            const script = document.createElement('script');
            script.src = src + "?t=" + Date.now();
            document.body.appendChild(script);
        }

        window.addEventListener('load', () => {
            setTimeout(() => {
                loadScript("profissao.js");
                loadScript("selecao-classe.js");
                loadScript("ficha.js");
                loadScript("dados.js");
                loadScript("inimigos.js");
                loadScript("medo.js");
                loadScript("npcs.js"); // <--- ADICIONE ESTA LINHA
                loadScript("tabletop.js");

                // Iniciar monitoramento
                setTimeout(() => {
                    if(window.monitorarNPCAtivo) window.monitorarNPCAtivo();
                    if(window.iniciarTabletop) window.iniciarTabletop();
                }, 1000);
            }, 500);
        });
    </script>
</body>
</html>